<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing Person Heatmap Analysis</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-dark bg-dark navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-map-marked-alt"></i>
                Missing Person Heatmap Analysis
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#upload">Upload</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#analysis">Analysis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#visualization">Visualizations</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Status Bar -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Pipeline Status</h5>
                        <div class="row text-center" id="statusBar">
                            <div class="col-md-3">
                                <div class="status-item" id="status-loaded">
                                    <i class="fas fa-upload fa-2x"></i>
                                    <p>Data Loaded</p>
                                    <span class="badge bg-secondary">Pending</span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="status-item" id="status-cleaned">
                                    <i class="fas fa-broom fa-2x"></i>
                                    <p>Data Cleaned</p>
                                    <span class="badge bg-secondary">Pending</span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="status-item" id="status-clustering">
                                    <i class="fas fa-project-diagram fa-2x"></i>
                                    <p>Clustering Done</p>
                                    <span class="badge bg-secondary">Pending</span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="status-item" id="status-prediction">
                                    <i class="fas fa-chart-line fa-2x"></i>
                                    <p>Prediction Ready</p>
                                    <span class="badge bg-secondary">Pending</span>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <small><strong>Records:</strong> <span id="recordCount">0</span> total, <span id="cleanRecordCount">0</span> cleaned</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upload Section -->
        <div class="row mb-4" id="upload">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="fas fa-file-upload"></i> Upload Data</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="fileInput" class="form-label">Select CSV File</label>
                            <input type="file" class="form-control" id="fileInput" accept=".csv">
                            <small class="form-text text-muted">
                                Required columns: Person ID, Gender, Age, Date Reported Missing, Latitude, Longitude, Barangay District
                            </small>
                        </div>
                        <button class="btn btn-primary" id="uploadBtn">
                            <i class="fas fa-upload"></i> Upload & Load Data
                        </button>
                        <button class="btn btn-success ms-2" id="useDemoBtn">
                            <i class="fas fa-flask"></i> Use Demo Data
                        </button>
                        <div id="uploadResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5><i class="fas fa-broom"></i> Data Preprocessing</h5>
                    </div>
                    <div class="card-body">
                        <p>Clean and preprocess the uploaded data for analysis.</p>
                        <button class="btn btn-success" id="cleanBtn" disabled>
                            <i class="fas fa-magic"></i> Clean Data
                        </button>
                        <div id="cleanResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Summary -->
        <div class="row mb-4" id="dataSummary" style="display: none;">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5><i class="fas fa-chart-bar"></i> Data Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <h6>Total Records</h6>
                                <p class="display-6" id="summaryTotal">-</p>
                            </div>
                            <div class="col-md-3">
                                <h6>Unique Locations</h6>
                                <p class="display-6" id="summaryLocations">-</p>
                            </div>
                            <div class="col-md-3">
                                <h6>Date Range</h6>
                                <p id="summaryDateRange">-</p>
                            </div>
                            <div class="col-md-3">
                                <h6>Gender Distribution</h6>
                                <div id="summaryGender"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis Section -->
        <div class="row mb-4" id="analysis">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-warning">
                        <h5><i class="fas fa-project-diagram"></i> Clustering Analysis</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Algorithm</label>
                            <select class="form-select" id="clusterAlgo">
                                <option value="kmeans">K-Means</option>
                                <option value="dbscan">DBSCAN</option>
                            </select>
                        </div>
                        <div class="mb-3" id="kmeansOptions">
                            <label class="form-label">Number of Clusters (K)</label>
                            <input type="number" class="form-control" id="numClusters" value="5" min="2" max="10">
                        </div>
                        <div class="mb-3" id="dbscanOptions" style="display: none;">
                            <label class="form-label">Epsilon (eps)</label>
                            <input type="number" class="form-control" id="epsValue" value="0.01" step="0.001">
                            <label class="form-label mt-2">Min Samples</label>
                            <input type="number" class="form-control" id="minSamples" value="5" min="2">
                        </div>
                        <button class="btn btn-warning" id="clusterBtn" disabled>
                            <i class="fas fa-cogs"></i> Run Clustering
                        </button>
                        <button class="btn btn-outline-warning ms-2" id="findOptimalBtn" disabled>
                            <i class="fas fa-search"></i> Find Optimal K
                        </button>
                        <div id="clusterResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-danger text-white">
                        <h5><i class="fas fa-chart-line"></i> Predictive Modeling</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Target Year</label>
                            <input type="number" class="form-control" id="targetYear" value="2026" min="2025">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Top N Hotspots</label>
                            <input type="number" class="form-control" id="topN" value="10" min="5" max="20">
                        </div>
                        <button class="btn btn-danger" id="predictBtn" disabled>
                            <i class="fas fa-crystal-ball"></i> Train & Predict
                        </button>
                        <button class="btn btn-outline-danger ms-2" id="trendsBtn" disabled>
                            <i class="fas fa-chart-area"></i> Analyze Trends
                        </button>
                        <div id="predictResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Section -->
        <div class="row mb-4" id="visualization">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <h5><i class="fas fa-map"></i> Visualizations</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <button class="btn btn-dark w-100" id="generateHeatmapBtn" disabled>
                                    <i class="fas fa-fire"></i> Generate Heatmap
                                </button>
                            </div>
                            <div class="col-md-6 mb-3">
                                <button class="btn btn-dark w-100" id="generateChartsBtn" disabled>
                                    <i class="fas fa-chart-pie"></i> Generate Charts
                                </button>
                            </div>
                        </div>
                        <div id="visualizationResult" class="mt-3"></div>
                        
                        <!-- Iframe for heatmap preview -->
                        <div id="heatmapPreview" style="display: none;" class="mt-3">
                            <h6>Heatmap Preview</h6>
                            <div class="ratio ratio-16x9">
                                <iframe id="heatmapFrame" src="" frameborder="0"></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Display -->
        <div class="row mb-4" id="resultsSection" style="display: none;">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-secondary text-white">
                        <h5><i class="fas fa-table"></i> Analysis Results</h5>
                    </div>
                    <div class="card-body">
                        <ul class="nav nav-tabs" id="resultsTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="cluster-tab" data-bs-toggle="tab" data-bs-target="#clusterTab" type="button">
                                    Cluster Stats
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="target-tab" data-bs-toggle="tab" data-bs-target="#targetTab" type="button">
                                    Target Groups
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="prediction-tab" data-bs-toggle="tab" data-bs-target="#predictionTab" type="button">
                                    Predictions
                                </button>
                            </li>
                        </ul>
                        <div class="tab-content mt-3" id="resultsTabContent">
                            <div class="tab-pane fade show active" id="clusterTab">
                                <div id="clusterStatsTable"></div>
                            </div>
                            <div class="tab-pane fade" id="targetTab">
                                <div id="targetGroupsTable"></div>
                            </div>
                            <div class="tab-pane fade" id="predictionTab">
                                <div id="predictionsTable"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-5">
        <p class="mb-0">Missing Person Heatmap Analysis System | Data Mining Project 2025</p>
    </footer>

    <!-- Toast for notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="notificationToast" class="toast" role="alert">
            <div class="toast-header">
                <strong class="me-auto">Notification</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body" id="toastMessage"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
